<html ng-app="myapp">

  <head>
    <meta charset="utf-8" />
    <title>AngularJS Plunker</title>
    <script>document.write('<base href="' + document.location + '" />');</script>
    <link rel="stylesheet" href="style.css" />
    <script data-require="angular.js@1.2.x" src="http://code.angularjs.org/1.2.7/angular.js" data-semver="1.2.7"></script>
    <script src="app.js"></script>
  </head>

  <body ng-controller="MainCtrl">
    <input type="text" ng-model="color" placeholder="Enter a color"/>
    <hello-world color="color" change-color='change()'/>
  </body>

</html>


var app = angular.module('myapp', []);

app.controller('MainCtrl', function($scope) {
  
  $scope.colors=['red','orange','green'];
  
  $scope.change=function(){
    return $scope.colors[Math.floor((Math.random()*3))];
  }
  
});

app.directive('helloWorld',function(){
  return{
    scope:{
      color:'=',
      changeColor:'&',
    },
    restrict: 'AE',
    replace: true,
    template: '<p style="background-color:{{color}}">Hello World</p>',
    link: function(scope,elem,attrs){
      elem.bind('click',function(){
        scope.$apply(function(){
          scope.color="white";
        });
      });
      elem.bind('mouseover',function(){
        elem.css('cursor','pointer');
        scope.$apply(function(){
          scope.color=scope.changeColor();
        });
      });
      scope.$watch('color',function(changedVal){
        console.log('changed detected');
      });
    }
  }
  
});
